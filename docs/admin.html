<!DOCTYPE html>
<html>
<head>
  <title>Admin Panel</title>
  <style>
    body{
      font-family: Arial;
      background-color: #111; /* siyah arka plan */
      color: white;
      padding:20px;
    }
    h2,h3{color:#00ffcc;}
    .section{
      background:#1e1e1e;
      padding:15px;
      margin-bottom:15px;
      border-radius:10px;
    }
    button{
      padding:6px 10px;
      border:none;
      border-radius:6px;
      cursor:pointer;
      margin-left:5px;
    }
    .green{background:#4CAF50;color:white;}
    .red{background:#f44336;color:white;}
    input{
      padding:6px;
      margin:5px;
      border-radius:6px;
      border:none;
    }
  </style>
</head>
<body>

<h2>ADMIN PANEL</h2>

<div class="section">
<h3>Onay Bekleyenler</h3>
<div id="waitingList"></div>
</div>

<div class="section">
<h3>OnaylanmÄ±ÅŸ Oyuncular</h3>
<div id="playersList"></div>
</div>

<div class="section">
<h3>Kelime Havuzu</h3>
<input type="text" id="wordInput" placeholder="Kelime">
<input type="text" id="hintInput" placeholder="Ä°pucu">
<button onclick="addWord()" class="green">Ekle</button>
<div id="wordList"></div>
</div>

<div class="section">
<h3>Oyun Kontrol</h3>
<button onclick="startGame()" class="green">ðŸŽ® Oyunu BaÅŸlat</button>
<button onclick="stopGame()" class="red">â›” Oyunu Durdur</button>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
var firebaseConfig = {
  apiKey: "AIzaSyBwzlkq9LZYCM_sk_M6tKfx5jme37Zw0u4",
  authDomain: "kelime-avi-bec9f.firebaseapp.com",
  databaseURL: "https://kelime-avi-bec9f-default-rtdb.firebaseio.com",
  projectId: "kelime-avi-bec9f",
  storageBucket: "kelime-avi-bec9f.firebasestorage.app",
  messagingSenderId: "154681825331",
  appId: "1:154681825331:web:7c8fec41e0d8ee2664eb46"
};

firebase.initializeApp(firebaseConfig);
var db = firebase.database();


// -------------------
// ONAY BEKLEYENLER
// -------------------
db.ref("waitingPlayers").on("value", function(snapshot){
  var html="";
  snapshot.forEach(function(child){
    html+=child.val().name+
    " <button onclick=\"approve('"+child.key+"','"+child.val().name+"')\" class='green'>âœ“</button><br>";
  });
  document.getElementById("waitingList").innerHTML=html;
});

function approve(id,name){
  db.ref("players").push({name:name,score:0});
  db.ref("waitingPlayers/"+id).remove();
}


// -------------------
// OYUNCULAR (ATMA)
// -------------------
db.ref("players").on("value", function(snapshot){
  var html="";
  snapshot.forEach(function(child){
    html+=child.val().name+
    " <button onclick=\"removePlayer('"+child.key+"')\" class='red'>âœ–</button><br>";
  });
  document.getElementById("playersList").innerHTML=html;
});

function removePlayer(id){
  db.ref("players/"+id).remove();
}


// -------------------
// KELÄ°ME EKLE / SÄ°L
// -------------------
function addWord(){
  var word=document.getElementById("wordInput").value.toUpperCase();
  var hint=document.getElementById("hintInput").value;
  if(word==""||hint=="") return;
  db.ref("words").push({word:word,hint:hint});
  document.getElementById("wordInput").value="";
  document.getElementById("hintInput").value="";
}

db.ref("words").on("value", function(snapshot){
  var html="";
  snapshot.forEach(function(child){
    html+=child.val().word+
    " <button onclick=\"removeWord('"+child.key+"')\" class='red'>âœ–</button><br>";
  });
  document.getElementById("wordList").innerHTML=html;
});

function removeWord(id){
  db.ref("words/"+id).remove();
}


// -------------------
// ðŸŽ® OYUNU BAÅžLAT
// -------------------
function startGame(){

  db.ref("words").once("value", function(snapshot){

    var words=[];
    snapshot.forEach(function(child){
      words.push(child.val());
    });

    if(words.length==0){
      alert("Kelime havuzu boÅŸ!");
      return;
    }

    var random = words[Math.floor(Math.random()*words.length)];

    // Ã–nce stage'i baÅŸlat
    db.ref("stage").set("started");

    // Sonra kelimeyi yaz
    db.ref("game/current").set({
      word: random.word,
      hint: random.hint,
      displayWord: "_ ".repeat(random.word.length),
      openedLetters: 0
    });

  });
}


// -------------------
// â›” OYUNU DURDUR
// -------------------
function stopGame(){
  db.ref("stage").set("stopped");
  db.ref("game/current").remove();
}

</script>

</body>
</html>
