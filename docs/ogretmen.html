<div class="card">
    <h2>ğŸ› ï¸ Oyun KontrolÃ¼</h2>
    Mod: <select id="mod">
        <option value="grup">ğŸ† Grup AÅŸamasÄ±</option>
        <option value="savas">ğŸ° TakÄ±m SavaÅŸÄ±</option>
        <option value="duello">âš”ï¸ DÃ¼ello</option>
    </select>
    | Kelime: <input type="number" id="kAdet" value="5" style="width:40px;">
    | HÄ±z: <input type="number" id="hiz" value="10" style="width:40px;">
    <button class="btn-main" onclick="baslat()" style="background:#3498db; width:auto; padding:10px 20px;">ğŸš€ BAÅLAT</button>
    <button onclick="db.ref('turnuva/maclar').remove()" style="background:#f39c12; color:white">â¹ï¸ MAÃ‡I BÄ°TÄ°R</button>
    <button onclick="db.ref('turnuva').remove(); location.reload()" style="background:#c0392b; color:white">ğŸ§¹ SÄ°STEMÄ° SIFIRLA</button>
</div>

<script>
    // ... Firebase yapÄ±landÄ±rman aynÄ± kalacak ...

    // CANLI SKOR VE GRUP TAKÄ°BÄ° (DÃ¼zeltilen KÄ±sÄ±m)
    db.ref("turnuva/maclar").on("value", s => {
        var h = "";
        s.forEach(m => {
            var v = m.val();
            h += `<div class="group-card" style="background:#2c3e50; color:white; padding:10px; margin-bottom:5px; border-radius:5px;">`;
            h += `<strong>${m.key} (${v.tip.toUpperCase()})</strong><br>`;
            
            if(v.tip === "duello") {
                h += `âš”ï¸ ${v.p1_ad}: ${v.p1_skor} - ${v.p2_ad}: ${v.p2_skor}`;
            } else {
                for(let tAd in v.skorlar) {
                    if(tAd !== "SÄ°STEM") h += `ğŸš© ${tAd}: ${v.skorlar[tAd]} P | `;
                }
            }
            h += `</div>`;
        });
        document.getElementById("canliSkorlar").innerHTML = h || "Aktif maÃ§ yok.";
    });

    function baslat() {
        var mod = document.getElementById("mod").value, kC = parseInt(document.getElementById("kAdet").value);
        db.ref("turnuva/havuz").once("value", hs => {
            if(!hs.exists()) return alert("Ã–nce kelime ekleyin!");
            var h = []; hs.forEach(x => h.push(x.val())); h = h.sort(() => 0.5 - Math.random());
            var kels = h.slice(0, kC).map(x => ({k:x.k, i:x.a, gizli:x.k.replace(/[A-ZÃ‡ÄÄ°Ã–ÅÃœ]/g,"-")}));
            let liste = window.onaylilar.sort(() => 0.5 - Math.random());

            if(mod === "grup") {
                for(let i=0; i < Math.ceil(liste.length/4); i++) {
                    let u = liste.slice(i*4, (i*4)+4), sk = {};
                    u.forEach(x => { sk[x.ad] = 0; db.ref("turnuva/oyuncular/"+x.id).update({durum:"eslesti", takim:x.ad}); });
                    db.ref("turnuva/maclar/Grup-"+(i+1)).set({ tip:"grup", durum:"aktif", aktifRaunt:0, kelimeler:kels, skorlar:sk });
                }
            } else if(mod === "savas") {
                db.ref("turnuva/maclar/Takim-Savasi").set({ tip:"savas", durum:"aktif", aktifRaunt:0, kelimeler:kels, skorlar:{"BAÅLIYOR":0} });
                window.onaylilar.forEach(o => db.ref("turnuva/oyuncular/"+o.id+"/durum").set("takim_secme_ekrani"));
            } else if(mod === "duello") {
                for(let i=0; i<liste.length; i+=2) if(liste[i+1]) {
                    db.ref("turnuva/maclar/Duel-"+(i/2+1)).set({ tip:"duello", durum:"aktif", p1:liste[i].id, p1_ad:liste[i].ad, p2:liste[i+1].id, p2_ad:liste[i+1].ad, p1_skor:0, p2_skor:0, aktifRaunt:0, kelimeler: kels });
                    db.ref("turnuva/oyuncular/"+liste[i].id).update({durum:"eslesti", takim:liste[i].ad});
                    db.ref("turnuva/oyuncular/"+liste[i+1].id).update({durum:"eslesti", takim:liste[i+1].ad});
                }
            }
            motorBaslat();
        });
    }
    // ... motorBaslat ve ekle fonksiyonlarÄ± aynÄ± ...
</script>
