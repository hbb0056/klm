<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Ã–ÄŸretmen Paneli</title>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
body{
  font-family:Arial;
}

button{
  margin:3px;
}
</style>
</head>

<body>

<h2>ğŸ‘©â€ğŸ« Ã–ÄŸretmen Paneli</h2>

<!-- Ã–ÄRENCÄ°LER -->

<h3>ğŸ‘¨â€ğŸ“ Ã–ÄŸrenci Listesi</h3>
<div id="ogrenciler"></div>

<hr>

<!-- KELÄ°ME EKLE -->

<h3>â• Kelime Ekle</h3>

<input id="kelime" placeholder="Kelime">
<input id="anlam" placeholder="Anlam">

<button onclick="ekle()">Ekle</button>

<hr>

<!-- HAVUZ -->

<h3>ğŸ“š Kelime Havuzu</h3>
<div id="kelimeler"></div>


<script>

var firebaseConfig = {
  apiKey: "AIzaSyBwzlkq9LZYCM_sk_M6tKfx5jme37Zw0u4",
  authDomain: "kelime-avi-bec9f.firebaseapp.com",
  databaseURL: "https://kelime-avi-bec9f-default-rtdb.firebaseio.com",
  projectId: "kelime-avi-bec9f",
  storageBucket: "kelime-avi-bec9f.appspot.com",
  messagingSenderId: "154681825331",
  appId: "1:154681825331:web:7c8fec41e0d8ee2664eb46"
};

firebase.initializeApp(firebaseConfig);
var db = firebase.database();


/* =======================
   Ã–ÄRENCÄ°LER + SIRALAMA
======================= */

db.ref("ogrenciler").on("value",function(s){

  var liste=[];

  s.forEach(function(e){

    var d=e.val();
    liste.push(d);
  });

  // PUANA GÃ–RE SIRALA
  liste.sort(function(a,b){
    return (b.puan||0)-(a.puan||0);
  });

  var html="";

  for(var i=0;i<liste.length;i++){

    var o=liste[i];

    html+=`
    ${i+1}. ${o.ad}
    | Puan: ${o.puan||0}
    | ${o.onay?"âœ”ï¸":"â³"}

    <button onclick="onayla('${o.ad}')">Onayla</button>
    <br>
    `;
  }

  document.getElementById("ogrenciler").innerHTML=html;
});


function onayla(ad){

  db.ref("ogrenciler").once("value",function(s){

    s.forEach(function(e){

      if(e.val().ad==ad){

        db.ref("ogrenciler/"+e.key+"/onay").set(true);
      }
    });
  });
}


/* =======================
   KELÄ°ME EKLE
======================= */

function ekle(){

  var k=document.getElementById("kelime").value.toUpperCase();
  var a=document.getElementById("anlam").value;

  if(k==""||a=="") return;

  db.ref("kelimeler").push({
    kelime:k,
    anlam:a
  });

  document.getElementById("kelime").value="";
  document.getElementById("anlam").value="";
}


/* =======================
   HAVUZ
======================= */

db.ref("kelimeler").on("value",function(s){

  var html="";

  s.forEach(function(e){

    var d=e.val();

    html+=`
    <b>${d.kelime}</b> - ${d.anlam}

    <button onclick="baslat('${e.key}')">â–¶ BaÅŸlat</button>

    <button onclick="sil('${e.key}')">âŒ</button>

    <br><br>
    `;
  });

  document.getElementById("kelimeler").innerHTML=html;
});


function sil(id){

  if(confirm("Silinsin mi?")){
    db.ref("kelimeler/"+id).remove();
  }
}


/* =======================
   OYUN BAÅLAT
======================= */

function baslat(id){

  db.ref("kelimeler/"+id).once("value",function(s){

    var d=s.val();

    if(!d) return;

    var gizli="";

    for(var i=0;i<d.kelime.length;i++){
      gizli+="-";
    }

    db.ref("aktif").set({
      kelime:d.kelime,
      gizli:gizli,
      anlam:d.anlam
    });

    alert("ğŸ® Oyun BaÅŸladÄ±!");
  });
}

</script>

</body>
</html>
