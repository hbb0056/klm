<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>YÃ¶netim Merkezi</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f4f7f6; padding: 20px; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .flex { display: flex; gap: 20px; }
        .col { flex: 1; }
        button { cursor: pointer; padding: 10px 20px; border-radius: 8px; border: none; font-weight: bold; }
        .btn-blue { background: #3498db; color: white; }
        .btn-green { background: #2ecc71; color: white; }
        .btn-red { background: #e74c3c; color: white; }
        .list-box { max-height: 200px; overflow-y: auto; border: 1px solid #eee; padding: 10px; }
        .item { display: flex; justify-content: space-between; margin-bottom: 5px; padding: 5px; border-bottom: 1px solid #f9f9f9; }
    </style>
</head>
<body>
    <div class="card">
        <h2>ğŸ® MOD SEÃ‡Ä°MÄ°: 
            <select id="mod" style="padding:10px; border-radius:5px;">
                <option value="savas">ğŸ° Grup SavaÅŸÄ± (TakÄ±m TakÄ±ma)</option>
                <option value="duello">âš”ï¸ DÃ¼ello (Teke Tek)</option>
            </select>
        </h2>
        <div class="flex">
            <span>Kelime SayÄ±sÄ±: <input type="number" id="kSayi" value="10" style="width:50px;"></span>
            <span>Harf HÄ±zÄ± (sn): <input type="number" id="sn" value="10" style="width:50px;"></span>
            <button class="btn-blue" onclick="baslat()">ğŸš€ SAVAÅI BAÅLAT</button>
            <button class="btn-red" onclick="db.ref('turnuva/maclar').remove(); db.ref('turnuva/oyuncular').remove();">SÄ±fÄ±rla</button>
        </div>
    </div>

    <div class="flex">
        <div class="col card">
            <h3>ğŸ‘¥ Onay Bekleyenler</h3>
            <div id="onayListesi" class="list-box"></div>
        </div>
        <div class="col card">
            <h3>ğŸ“Š TakÄ±m PuanlarÄ±</h3>
            <div id="skorTahtasi" class="list-box"></div>
        </div>
    </div>

    <script>
        var firebaseConfig = { apiKey: "AIzaSyBwzlkq9LZYCM_sk_M6tKfx5jme37Zw0u4", authDomain: "kelime-avi-bec9f.firebaseapp.com", databaseURL: "https://kelime-avi-bec9f-default-rtdb.firebaseio.com", projectId: "kelime-avi-bec9f", storageBucket: "kelime-avi-bec9f.appspot.com", messagingSenderId: "154681825331", appId: "1:154681825331:web:7c8fec41e0d8ee2664eb46" };
        firebase.initializeApp(firebaseConfig);
        var db = firebase.database();

        // Onay Sistemi
        db.ref("turnuva/oyuncular").on("value", s => {
            var html = "";
            s.forEach(o => {
                var d = o.val();
                if(d.durum === "onay_bekliyor") {
                    html += `<div class="item">${d.ad} (${d.takim}) <button class="btn-green" onclick="db.ref('turnuva/oyuncular/${o.key}/durum').set('bekliyor')">Onayla</button></div>`;
                }
            });
            document.getElementById("onayListesi").innerHTML = html || "Yeni istek yok.";
        });

        function baslat() {
            var mod = document.getElementById("mod").value;
            var kAdet = parseInt(document.getElementById("kSayi").value);
            
            db.ref("turnuva/havuz").once("value", hs => {
                var havuz = []; hs.forEach(h => havuz.push(h.val()));
                havuz = havuz.sort(() => 0.5 - Math.random()).slice(0, kAdet);
                var kelimeler = havuz.map(x => ({k:x.k, i:x.a, gizli:x.k.replace(/[A-ZÃ‡ÄÄ°Ã–ÅÃœ]/g, "-")}));

                if(mod === "savas") {
                    var macID = "grup_savasi_1";
                    db.ref("turnuva/maclar/" + macID).set({
                        tip: "savas",
                        kelimeler: kelimeler,
                        aktifRaunt: 0,
                        skorlar: { "TakÄ±m A":0, "TakÄ±m B":0, "TakÄ±m C":0, "TakÄ±m D":0 },
                        durum: "aktif"
                    });
                    db.ref("turnuva/oyuncular").once("value", os => {
                        os.forEach(o => { if(o.val().durum === "bekliyor") db.ref("turnuva/oyuncular/"+o.key+"/durum").set("eslesti"); });
                    });
                }
            });
            // Harf motoru kodlarÄ± buraya eklenebilir (Ã¶ncekiyle aynÄ±)
        }

        db.ref("turnuva/maclar/grup_savasi_1/skorlar").on("value", s => {
            var html = "";
            if(s.exists()) {
                s.forEach(t => { html += `<div class="item"><b>${t.key}:</b> <span>${t.val()} Puan</span></div>`; });
            }
            document.getElementById("skorTahtasi").innerHTML = html;
        });
    </script>
</body>
</html>
